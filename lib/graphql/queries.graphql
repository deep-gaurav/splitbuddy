# Write your query or mutation here
fragment UserFields on User {
  id
  name
  phone
  email
}

fragment UserPaysFields on User{
  upiIds
  toPay
  toReceive
}

fragment GroupFields on Group {
  id
  name
  creator {
    ...UserFields
  }
  members {
    ...UserFields
  }
  toPay
  toReceive
  createdAt
}

fragment ExpenseFields on Expense {
  id
  title
  createdAt
  creator {
    ...UserFields
  }
  amount
  toPay
  toReceive
  splits {
    ...SplitFields
  }
}

fragment SplitFields on Split {
  id
  amount
  amountSettled
  fromUser {
    ...UserFields
  }
  toUser {
    ...UserFields
  }
  isSettled
}

fragment GroupWithExpenses on Group {
  ...GroupFields
  expenses(skip: $skip, limit: $limit) {
    ...ExpenseFields
  }
}


query user {
  user {
    __typename
    ... on Registered {
      user {
        ...UserFields
      }
    }
    ... on Unregistered {
      phone
    }
  }
}

query groups {
  groups{
    ...GroupFields
  }
}

query interacted_users {
  interactedUsers{
    ...UserFields
    ...UserPaysFields
  }
}

query group($skip: Int!, $limit: Int!, $groupId: String!) {
  group(id: $groupId) {
    ...GroupWithExpenses
  }
}

mutation signup($name: String!, $upi_id:String) {
  signup(name: $name,upiId:$upi_id) {
    user{
      ...UserFields
    }
    tokens{
      accessToken
      refreshToken
    }
  }
}

mutation create_group($name: String!) {
  createGroup(name: $name) {
    ...GroupFields
  }
}

mutation add_to_group($email: String!, $groupId: String!) {
  addToGroupByEmail(email: $email, groupId: $groupId)
}

mutation add_expense(
  $title: String!
  $amount: Int!
  $splits: [SplitInput!]!
  $groupId: String!
) {
  addExpense(
    title: $title
    amount: $amount
    splits: $splits
    groupId: $groupId
  ) {
    ...ExpenseFields
  }
}

mutation settle_user($amount: Int!, $userId:String!){
  settleUser(amount:$amount,userId:$userId)
}

mutation settle_expense($amount:Int!, $expenseId: String!){
  settleExpense(expenseId:$expenseId, amount:$amount){
    ...ExpenseFields
  }
}

mutation send_email_otp($email: String!){
  sendEmailOtp(email:$email)
}

mutation verify_email_otp($email:String!, $otp:String!){
  verifyOtp(email:$email, otp:$otp){
    __typename
    ... on UserSignedUp{
      accessToken,
      refreshToken
    }
    ... on UserNotSignedUp{
      signupToken
    }
  }
}

mutation refresh_token($refresh_token: String!){
  refreshToken(refreshToken:$refresh_token){
    accessToken
    refreshToken
  }
}